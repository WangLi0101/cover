### 迭代器

- 迭代器本质是一个对象
- 迭代器返回一个 next() 函数， 函数返回一个对象， 该对象有两个属性：value 和 done

### 基本实现

```javascript
const arr = [1, 2, 3, 4, 5];

const createIterator = (arr) => {
  let idx = 0;
  return {
    next() {
      return idx < arr.length
        ? { value: arr[idx++], done: false }
        : { value: undefined, done: true };
    },
  };
};
```

### 可迭代对象

- 可迭代对象是一个对象， 该对象有一个 Symbol.iterator 属性
- Symbol.iterator 属性是一个函数， 函数返回一个迭代器

#### 内置可迭代对象

- `String`
- `Array`
- `Set`
- `NodeList` 类数组对象
- `Arguments` 类数组对象
- `Map`

#### 查看可迭代对象的 Symbol.iterator 属性

```javascript
const arr = [1, 2, 3, 4, 5];

console.log(arr[Symbol.iterator]); // f values() { [native code] }

let iterator = arr[Symbol.iterator]();
console.log(iterator.next()); // { value: 1, done: false }
console.log(iterator.next()); // { value: 2, done: false }
...
```

#### 实现可迭代对象

```javascript
const obj = {
  arr: [1, 2, 3, 4, 5],
  [Symbol.iterator]() {
    let idx = 0;
    return {
      next() {
        return idx < obj.arr.length
          ? { value: idx++, done: false }
          : { value: undefined, done: true };
      },
    };
  },
};

// 使用
const iterator = obj[Symbol.iterator]();
console.log(iterator.next()); // { value: 1, done: false }
console.log(iterator.next()); // { value: 2, done: false }
```

> for...of 循环会自动调用 Symbol.iterator 方法

### 生成器

- 生成器是一个函数， 函数内部使用 `yield` 关键字
- 生成器函数返回一个迭代器

#### 基本实现

```javascript
function* createGenerator() {
  yield 1;
  yield 2;
}

const generator = createGenerator();
console.log(generator.next()); // { value: 1, done: false }
console.log(generator.next()); // { value: 2, done: false }
console.log(generator.next()); // { value: undefined, done: true }
```

#### 分段传参

```javascript
function* createGenerator() {
  const first = yield 1;
  const second = yield first + 2;
  yield second + 3;
}

const generator = createGenerator();
console.log(generator.next()); // { value: 1, done: false }
console.log(generator.next(4)); // { value: 6, done: false }
console.log(generator.next(5)); // { value: 8, done: false }
console.log(generator.next()); // { value: undefined, done: true }
```

#### `yield*` 依次返回可迭代对象的值

```javascript
function* createGenerator() {
  yield* [1, 2, 3, 4, 5];
}

const generator = createGenerator();
console.log(generator.next()); // { value: 1, done: false }
console.log(generator.next()); // { value: 2, done: false }
```
