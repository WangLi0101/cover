# 从字段到函数的推倒

![封面图](../photo/type-inference-cover.webp)

实现一个watch函数，接收一个对象，返回一个拥有on方法的对象，on方法接收两个参数:
 - 第一个参数为事件名(事件名称必须为keyChanged)
 - 第二个参数为callBack(newValue,oldValue) newValue,oldValue 为 对象对应Key的类型

```ts
type Watcher<T> = {
  on<K extends string & keyof T>(
    eventName: `${K}Changed`,
    callBack: (newValue: T[K], oldValue: T[K]) => void
  ): void;
};

declare function watch<T>(obj: T): Watcher<T>;

const personWatch = watch({
  age: 18,
  name: "zs",
});

personWatch.on("ageChanged", (newValue, oldValue) => {});
```