### 如何判断一个对象是否存在循环引用

#### 方法一

```javascript
const isCircular = (obj) => {
  const detect = (obj) => {
    if (!obj || typeof obj !== "object") return false;
    if (seen.has(obj)) return true;
    seen.add(obj);
    for (const key in obj) {
      if (Object.hasOwnProperty.call(obj, key)) {
        if (detect(obj[key])) return true;
      }
    }
    // 将当前对象删除，防止误判
    seen.delete(obj);
    return false;
  };
  const seen = new WeakSet();
  return detect(obj);
};
```

##### 为什么要删除当前对象

```javascript
// 对象的属性指向同一引用，如果不删除的话，会被认为是循环引用
let obj = {
  name: "Libra",
};
let obj4 = {
  obj1: obj,
  obj2: obj,
};
```

#### 方法二

```javascript
const isCircular = (obj) => {
  try {
    // 如果对象是循环引用，JSON.stringify会抛出错误
    JSON.stringify(obj);
  } catch (error) {
    return true;
  }
  return false;
};
```
