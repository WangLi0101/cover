## 可选参数（Optional Parameters）

### 什么是可选参数

**可选参数**允许函数在调用时省略某些参数。这在函数有多个参数时尤其有用，调用者可以根据需要提供必要的参数，而不必为每个参数都传值。可选参数通过在参数名称后加上问号（`?`）来标记。

### 可选参数的语法

```typescript
function functionName(param1: Type1, param2?: Type2, param3?: Type3): ReturnType {
    // 函数体
}
```

- **`param2?` 和 `param3?`** 表示这些参数是可选的。

### 示例 1：基本使用

```typescript
function greet(name: string, greeting?: string): string {
    if (greeting) {
        return `${greeting}, ${name}!`;
    } else {
        return `Hello, ${name}!`;
    }
}

console.log(greet("Alice")); // 输出: Hello, Alice!
console.log(greet("Bob", "Good morning")); // 输出: Good morning, Bob!
```

### 示例 2：多个可选参数

```typescript
function createUser(username: string, email?: string, age?: number): void {
    console.log(`Username: ${username}`);
    if (email) {
        console.log(`Email: ${email}`);
    }
    if (age !== undefined) {
        console.log(`Age: ${age}`);
    }
}

createUser("Charlie");
// 输出:
// Username: Charlie

createUser("Dana", "dana@example.com", 28);
// 输出:
// Username: Dana
// Email: dana@example.com
// Age: 28
```

### 可选参数的位置

在 TypeScript 中，**可选参数必须位于参数列表的末尾**。这意味着在一个函数的参数列表中，如果一个参数被标记为可选，那么所有在它之后的参数也必须是可选的。

### 可选参数与联合类型

可选参数实际上是联合类型的一种特例。一个可选参数 `param?: Type` 相当于 `param: Type | undefined`。

```typescript
function example(param?: string): void {
    // param 的类型是 string | undefined
}
```

## 默认参数（Default Parameters）

### 什么是默认参数

**默认参数**允许在函数定义时为某些参数提供默认值。当调用函数时，如果未提供这些参数，函数将使用预设的默认值。默认参数通过在参数名称后使用赋值运算符（`=`）来设置。

### 默认参数的语法

```typescript
function functionName(param1: Type1, param2: Type2 = defaultValue, param3: Type3 = defaultValue): ReturnType {
    // 函数体
}
```

- **`param2: Type2 = defaultValue`** 表示 `param2` 有一个默认值 `defaultValue`。

### 示例 1：基本使用

```typescript
function greet(name: string, greeting: string = "Hello"): string {
    return `${greeting}, ${name}!`;
}

console.log(greet("Eve")); // 输出: Hello, Eve!
console.log(greet("Frank", "Good evening")); // 输出: Good evening, Frank!
```

### 示例 2：多个默认参数

```typescript
function createUser(username: string, email: string = "not_provided@example.com", age: number = 18): void {
    console.log(`Username: ${username}`);
    console.log(`Email: ${email}`);
    console.log(`Age: ${age}`);
}

createUser("Grace");
// 输出:
// Username: Grace
// Email: not_provided@example.com
// Age: 18

createUser("Heidi", "heidi@example.com");
// 输出:
// Username: Heidi
// Email: heidi@example.com
// Age: 18

createUser("Ivan", "ivan@example.com", 25);
// 输出:
// Username: Ivan
// Email: ivan@example.com
// Age: 25
```

## 注意事项与最佳实践

### 1. 参数顺序

- **可选参数和默认参数应放在参数列表的末尾**。这样可以避免调用函数时的参数混淆。

  ```typescript
  // 正确
  function example(a: number, b?: string, c: boolean = true): void {}
  
  // 错误
  function example(a?: number, b: string, c: boolean = true): void {}
  // 错误原因: 可选参数 `a` 前面有非可选参数 `b`
  ```

### 2. 与重载的关系

TypeScript 函数重载与可选参数和默认参数结合使用时，需要小心定义重载签名，以避免冲突和类型不明确。

```typescript
// 函数重载示例
function request(url: string): void;
function request(url: string, method: string): void;
function request(url: string, method: string = "GET"): void {
    console.log(`URL: ${url}, Method: ${method}`);
}

request("https://api.example.com");
// 输出: URL: https://api.example.com, Method: GET

request("https://api.example.com", "POST");
// 输出: URL: https://api.example.com, Method: POST
```

### 3. 与解构赋值结合使用

在使用解构赋值时，可以为对象参数提供默认值，同时使用默认参数和可选参数。

```typescript
interface Options {
    timeout?: number;
    retry?: number;
}

function initialize({ timeout = 1000, retry = 3 }: Options = {}): void {
    console.log(`Timeout: ${timeout}, Retry: ${retry}`);
}

initialize();
// 输出: Timeout: 1000, Retry: 3

initialize({ timeout: 2000 });
// 输出: Timeout: 2000, Retry: 3
```

## 深入理解

### 可选参数的底层实现

在 TypeScript 编译为 JavaScript 时，可选参数会被编译为正常的函数参数，未传递的参数会是 `undefined`。默认参数则会在函数体内赋予默认值。

#### 编译示例

```typescript
// TypeScript
function greet(name: string, greeting?: string): string {
    return greeting ? `${greeting}, ${name}!` : `Hello, ${name}!`;
}

// 编译后的 JavaScript
function greet(name, greeting) {
    return greeting ? greeting + ", " + name + "!" : "Hello, " + name + "!";
}
```

```typescript
// TypeScript
function greet(name: string, greeting: string = "Hello"): string {
    return `${greeting}, ${name}!`;
}

// 编译后的 JavaScript（ES5）
function greet(name, greeting) {
    if (greeting === void 0) { greeting = "Hello"; }
    return greeting + ", " + name + "!";
}

// 编译后的 JavaScript（ES6+）
function greet(name, greeting = "Hello") {
    return `${greeting}, ${name}!`;
}
```

### 默认参数与参数重载

默认参数可以简化函数重载，避免为不同参数组合编写多个重载签名。

```typescript
// 使用默认参数
function buildUrl(base: string, path: string = "", query: string = ""): string {
    return `${base}/${path}?${query}`;
}

buildUrl("https://api.example.com"); // https://api.example.com/? 
buildUrl("https://api.example.com", "users"); // https://api.example.com/users? 
buildUrl("https://api.example.com", "users", "id=1"); // https://api.example.com/users?id=1
```
