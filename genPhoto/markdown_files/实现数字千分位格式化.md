### 实现数字千分位格式化

#### 方法一

```js
function formatNumber(num) {
  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}
```

`\b` 代表单词边界（Word Boundaries）：

- 它匹配的是一个位置，类似 ^ 和 $ 代表字符串的开头和结尾
- 单词边界的三种位置：
  1. 字符串第一个字符的前面（如果这个字符是单词字符）
  2. 字符串最后一个字符的后面（如果这个字符是单词字符）
  3. 字符串中两个字符之间（一个是单词字符，另一个不是）

`\B` 代表非单词边界（Non-Word Boundaries）：

- 它匹配的是一个位置，类似 `\b` 的反义
- 非单词边界的三种位置：
  1. 字符串第一个字符的后面（如果这个字符是单词字符）
  2. 字符串最后一个字符的前面（如果这个字符是单词字符）
  3. 字符串中两个字符之间（两个都是非单词字符）

单词字符（word character）：

- 能组成一个词（word）的字符，如 w
- 非单词字符（non-word characters）与之相反，如 , 和空格

正则表达式解析：

- `\d{3}+`：匹配多个连续的三位数字
- `x(?!y)`：正向否定查找，仅当 'x' 后面不跟着 'y' 时匹配 'x'
- `(?!\d)`：后面不能跟着数字
- `x(?=y)`：正向肯定查找，仅当 'x' 后面跟着 'y' 时匹配 'x'

匹配过程解析：

1. 匹配 1 和 2 之间：

   - 满足 `\B` 要求
   - 后面跟着 234567，满足 `(\d{3})+`
   - 7 后面是 .，不是数字，满足 `(?!\d)`
   - 结果：在 1 2 之间加上 ,

2. 匹配 2 3 之间：

   - 满足 `\B` 要求
   - 后面跟着 345，满足 `(\d{3})+`
   - 5 后面是数字 6，不满足 `(?!\d)`
   - 结果：不匹配

3. 继续类似上述过程进行匹配

#### 方法二

```js
function formatNumber(n, sep = ",") {
  function convert(s, p) {
    return s
      .split("")
      .reverse()
      .reduce((a, c, i) => c + (i > 0 && i % 3 === 0 ? p : "") + a, "");
  }
  const [int, dec] = Math.abs(n).toString().split(".");
  const sign = n < 0 ? "-" : "";
  const intStr = convert(int, sep);
  const decStr = dec ? "." + convert(dec, sep) : "";
  return sign + intStr + decStr;
}
```
